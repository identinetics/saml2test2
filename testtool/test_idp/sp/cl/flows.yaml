Flows:
  IDP-Metadata-verify:
    tc_id: idp-mv
    desc: Verifies that the IdP metadata adheres to the saml2int spec
    sequence:
      - check_metadata.CheckSaml2IntMetaData
    profile: .
    sp: basic
  IDP-AuthnPost-nid_transient:
    desc: AuthnRequest using HTTP-POST
    name: Basic SAML2 AuthnRequest using HTTP POST
    profile: .
    sequence:
    -
      - AuthnPostRequest
      - set_request_args:
          nameid_format: urn:oasis:names:tc:SAML:2.0:nameid-format:transient
    sp: basic
    tc_id: idp-auth-post-02
    tests:
      verify_subject:
        name_id.format: urn:oasis:names:tc:SAML:2.0:nameid-format:transient
  IDP-AuthnPost-verify:
    desc: AuthnRequest using HTTP-POST
    name: Basic SAML2 AuthnRequest using HTTP POST
    profile: .
    sequence:
    -
      - AuthnPostRequest
      - set_request_args:
          nameid_format: urn:oasis:names:tc:SAML:2.0:nameid-format:transient
    sp: basic
    tc_id: idp-auth-post-01
  IDP-AuthnRedirect-nid_email:
    desc: Basic SAML2 AuthnRequest, HTTP-Redirect, NameID-email specified
    name: AuthnRequest, email nameID
    profile: .
    sequence:
    -
      - AuthnRedirectRequest
      - set_request_args:
          nameid_format: urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress
    sp: basic
    tc_id: idp-auth-re-02
    tests:
      verify_subject:
        name_id.format: urn:oasis:names:tc:SAML:1.1:nameid-format:emailAddress
  IDP-AuthnRedirect-nid_transient:
    desc: Basic SAML2 AuthnRequest, HTTP-Redirect, transient name ID
    name: AuthnRequest, NameID-trans
    profile: .
    sequence:
    -
      - AuthnRedirectRequest
      - set_request_args:
          nameid_format: urn:oasis:names:tc:SAML:2.0:nameid-format:transient
    sp: basic
    tc_id: idp-auth-re-01
    tests:
      verify_subject:
        name_id.format: urn:oasis:names:tc:SAML:2.0:nameid-format:transient
  IDP-AuthnRedirect-nid_unspecified:
    desc: Basic SAML2 AuthnRequest, HTTP-Redirect, NameID-unspec
    name: AuthnRequest with unspecified nameID format
    profile: .
    sequence:
    -
      - AuthnRedirectRequest
      - set_request_args:
          nameid_format: urn:oasis:names:tc:SAML:2.0:nameid-format:unspecified
    sp: basic
    tc_id: idp-auth-re-04
  IDP-AuthnRedirect-no_nid:
    desc: Basic SAML2 AuthnRequest, HTTP-Redirect, no NameID format specified
    name: AuthnRequest no specified nameID format
    profile: .
    sequence:
    -
      - AuthnRedirectRequest
      - set_request_args:
          nameid_format: ''
    sp: basic
    tc_id: idp-auth-re-03
  IDP-AuthnRedirect-verify:
    desc: Uses AuthnRequest to check connectivity
    profile: .
    sequence:
      - AuthnRedirectRequest
    sp: basic
    tc_id: idp-con-01
    tests:
      verify_attributes: {}
  IDP-EntityCategory-coco:
    desc: Uses AuthnRequest to verify CoCo entity category support
    profile: .
    sequence:
      - AuthnRedirectRequest
    sp: coco
    tc_id: idp-coco-01
    tests:
      verify_entity_category: {}
  IDP-EntityCategory-ras:
    desc: Uses AuthnRequest to verify R&S entity category support
    profile: .
    sequence:
      - AuthnRedirectRequest
    sp: research_and_scholarship
    tc_id: idp-ras-01
    tests:
      verify_entity_category: {}
  IDP-Logout-soap:
    tc_id: S2c-03,
    desc: An Authnrequest followed by a logout request,
    sequence:
      - AuthnRedirectRequest
      -
        - LogOutRequestSoap
        - setup_logout: {}
    tests:
      verify_logout: {}
    sp: basic
    profile: .

Order:
  - IDP-Metadata
  - IDP-Connection
  - IDP-AuthnRedirect
  - IDP-AuthnPost
  - IDP-EntityCategory
  - IDP-Logout

Desc:
  IDP-Metadata: Idp metadata
  IDP-Connection: IdP Connection
  IDP-AuthnRedirect: IDP Authentication HTTP Redirect
  IDP-AuthnPost: IDP Authentication using HTTP POST
  IDP-EntityCategory: Entity Category Compliance
  IDP-Logout: IDP Logout